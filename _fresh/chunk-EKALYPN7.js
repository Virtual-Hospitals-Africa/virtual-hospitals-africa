import{a as L}from"./chunk-JL43BJ7J.js";import{b as S,d as I,g as E,h as k}from"./chunk-Z5ZZXA55.js";import{a as i}from"./chunk-QPM7RCMO.js";import{h as w}from"./chunk-ACALVSGI.js";import{a as r,b as p,e as v}from"./chunk-DZI5S33S.js";import{a as t}from"./chunk-D7WMKMTL.js";function H(o){return L(o)&&typeof o.id=="number"}function A({href:o,name:d,required:_,label:P,value:c,addable:b,onSelect:l}){let[R,f]=r(!1),[s,h]=r(H(c)?c:null),[y,$]=r([]),[n,g]=r(c?.name??""),[q]=r({delay:k(g,220)}),a=v(()=>{let e=document.activeElement===document.querySelector(`input[name="${d}_name"]`);f(e)},[f]);p(()=>(self.addEventListener("click",a),self.addEventListener("focus",a),self.addEventListener("blur",a),()=>{self.removeEventListener("click",a),self.removeEventListener("focus",a),self.removeEventListener("blur",a)})),p(()=>{let e=new URL(`${window.location.origin}${o}`);n&&n!==c?.name&&e.searchParams.set("search",n),fetch(e,{headers:{accept:"application/json"}}).then(async u=>{let m=await u.json();i(Array.isArray(m)),$(m)}).catch(console.error)},[n]);let D=R&&(y.length>0||n&&b);return t("div",{className:"w-full",children:[t(w,{name:`${d}_name`,label:P,value:s?.name,required:_,onInput:e=>{i(e.target),i("value"in e.target),i(typeof e.target.value=="string"),h(null),q.delay(e.target.value)},children:D&&t(I,{children:[y.map(e=>t(S,{person:{id:e.id,name:e.name},isSelected:s?.id===e.id,onSelect:()=>{f(!1),h({id:e.id,name:e.name}),g(e.name),l&&l(e);let u=document.querySelector(`input[name="${d}_name"]`);i(u instanceof HTMLInputElement);let m=new KeyboardEvent("keydown",{key:"Tab",code:"Tab",keyCode:9,which:9,bubbles:!0,cancelable:!0});u.dispatchEvent(m)}})),b&&n?t(E,{searchedValue:n,isSelected:s?.id==="add",onSelect:()=>{h({name:n,id:"add"}),l&&l({name:n,phone_number:void 0,date_of_birth:void 0,ethnicity:void 0,national_id_number:void 0,gender:void 0})}}):null]})}),t("span",{id:"nonsense"}),typeof s?.id=="number"&&t("input",{type:"hidden",name:`${d}_id`,value:s.id})]})}export{A as a};
