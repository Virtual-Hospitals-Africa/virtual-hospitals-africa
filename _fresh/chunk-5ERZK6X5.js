import{b as v,d as y,g,h as w}from"./chunk-Z5ZZXA55.js";import{a as r}from"./chunk-QPM7RCMO.js";import{g as E}from"./chunk-E36SNTQA.js";import{a,b as f,e as S}from"./chunk-DZI5S33S.js";import{a as t}from"./chunk-D7WMKMTL.js";function _({href:I,name:c,required:L,label:k,value:d,addable:p}){let[R,u]=a(!1),[o,m]=a(d||null),[h,$]=a([]),[n,b]=a(d?.name??""),[q]=a({delay:w(b,220)}),s=S(()=>{let e=document.activeElement===document.querySelector(`input[name="${c}_name"]`);u(e)},[u]);f(()=>(self.addEventListener("click",s),self.addEventListener("focus",s),self.addEventListener("blur",s),()=>{self.removeEventListener("click",s),self.removeEventListener("focus",s),self.removeEventListener("blur",s)})),f(()=>{let e=new URL(`${window.location.origin}${I}`);n&&n!==d?.name&&e.searchParams.set("search",n),fetch(e,{headers:{accept:"application/json"}}).then(async l=>{let i=await l.json();r(Array.isArray(i)),$(i)}).catch(console.error)},[n]);let P=R&&(h.length>0||n&&p);return t("div",{className:"w-full",children:[t(E,{name:`${c}_name`,label:k,value:o?.name,required:L,onInput:e=>{r(e.target),r("value"in e.target),r(typeof e.target.value=="string"),m(null),q.delay(e.target.value)},children:P&&t(y,{children:[h.map(e=>t(v,{person:e,isSelected:o?.id===e.id,onSelect:()=>{u(!1),m(e),b(e.name);let l=document.querySelector(`input[name="${c}_name"]`);r(l instanceof HTMLInputElement);let i=new KeyboardEvent("keydown",{key:"Tab",code:"Tab",keyCode:9,which:9,bubbles:!0,cancelable:!0});l.dispatchEvent(i)}})),p&&n?t(g,{searchedValue:n,isSelected:o?.id==="add",onSelect:()=>m({name:n,id:"add"})}):null]})}),t("span",{id:"nonsense"}),typeof o?.id=="number"&&t("input",{type:"hidden",name:`${c}_id`,value:o.id})]})}export{_ as a};
