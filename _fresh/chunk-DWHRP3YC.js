import{b as S,d as y,g,h as w}from"./chunk-Z5ZZXA55.js";import{a as r}from"./chunk-QPM7RCMO.js";import{g as E}from"./chunk-E36SNTQA.js";import{a as s,b as f,e as v}from"./chunk-DZI5S33S.js";import{a as t}from"./chunk-D7WMKMTL.js";function P({href:I,name:l,required:L,label:k,value:d,addable:h}){let[R,u]=s(!1),[o,m]=s(d||null),[p,_]=s([]),[n,b]=s(d?.name??""),[$]=s({delay:w(b,220)}),a=v(()=>{let e=document.activeElement===document.querySelector(`input[name="${l}_name"]`);u(e)},[u]);f(()=>(self.addEventListener("click",a),self.addEventListener("focus",a),self.addEventListener("blur",a),()=>{self.removeEventListener("click",a),self.removeEventListener("focus",a),self.removeEventListener("blur",a)})),f(()=>{let e=new URL(`${window.location.origin}${I}`);n&&n!==d?.name&&e.searchParams.set("search",n),fetch(e,{headers:{accept:"application/json"}}).then(async c=>{let i=await c.json();r(Array.isArray(i)),_(i)}).catch(console.error)},[n]);let q=R&&(p.length>0||n&&h);return t("div",{className:"w-full",children:[t(E,{name:`${l}_name`,label:k,value:o?.name,required:L,onInput:e=>{r(e.target),r("value"in e.target),r(typeof e.target.value=="string"),m(null),$.delay(e.target.value)},children:q&&t(y,{children:[p.map(e=>t(S,{person:e,isSelected:o?.id===e.id,onSelect:()=>{u(!1),m(e),b(e.name);let c=document.querySelector(`input[name="${l}_name"]`);r(c instanceof HTMLInputElement);let i=new KeyboardEvent("keydown",{key:"Tab",code:"Tab",keyCode:9,which:9,bubbles:!0,cancelable:!0});c.dispatchEvent(i)}})),h&&n?t(g,{searchedValue:n,isSelected:o?.id==="add",onSelect:()=>m({name:n,id:"add"})}):null]})}),t("span",{id:"nonsense"}),o&&t("input",{type:"hidden",name:`${l}_id`,value:o.id})]})}export{P as a};
