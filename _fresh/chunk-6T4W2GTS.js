import{a as k}from"./chunk-JL43BJ7J.js";import{b as v,d as g,g as E,h as w}from"./chunk-Z5ZZXA55.js";import{a as r}from"./chunk-QPM7RCMO.js";import{g as I}from"./chunk-E36SNTQA.js";import{a,b as p,e as y}from"./chunk-DZI5S33S.js";import{a as t}from"./chunk-D7WMKMTL.js";function _(c){return k(c)&&typeof c.id=="number"}function A({href:c,name:i,required:L,label:R,value:l,addable:h}){let[$,m]=a(!1),[o,f]=a(_(l)?l:null),[b,q]=a([]),[n,S]=a(l?.name??""),[H]=a({delay:w(S,220)}),s=y(()=>{let e=document.activeElement===document.querySelector(`input[name="${i}_name"]`);m(e)},[m]);p(()=>(self.addEventListener("click",s),self.addEventListener("focus",s),self.addEventListener("blur",s),()=>{self.removeEventListener("click",s),self.removeEventListener("focus",s),self.removeEventListener("blur",s)})),p(()=>{let e=new URL(`${window.location.origin}${c}`);n&&n!==l?.name&&e.searchParams.set("search",n),fetch(e,{headers:{accept:"application/json"}}).then(async d=>{let u=await d.json();r(Array.isArray(u)),q(u)}).catch(console.error)},[n]);let P=$&&(b.length>0||n&&h);return t("div",{className:"w-full",children:[t(I,{name:`${i}_name`,label:R,value:o?.name,required:L,onInput:e=>{r(e.target),r("value"in e.target),r(typeof e.target.value=="string"),f(null),H.delay(e.target.value)},children:P&&t(g,{children:[b.map(e=>t(v,{person:e,isSelected:o?.id===e.id,onSelect:()=>{m(!1),f(e),S(e.name);let d=document.querySelector(`input[name="${i}_name"]`);r(d instanceof HTMLInputElement);let u=new KeyboardEvent("keydown",{key:"Tab",code:"Tab",keyCode:9,which:9,bubbles:!0,cancelable:!0});d.dispatchEvent(u)}})),h&&n?t(E,{searchedValue:n,isSelected:o?.id==="add",onSelect:()=>f({name:n,id:"add"})}):null]})}),t("span",{id:"nonsense"}),typeof o?.id=="number"&&t("input",{type:"hidden",name:`${i}_id`,value:o.id})]})}export{A as a};
