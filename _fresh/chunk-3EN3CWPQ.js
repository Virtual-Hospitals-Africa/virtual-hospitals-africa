import{a as g}from"./chunk-AAS3MA3C.js";import{d as _,f,h as S}from"./chunk-Z5ZZXA55.js";import{a as i}from"./chunk-QPM7RCMO.js";import{h}from"./chunk-5D2L5IOQ.js";import{a as n,b as m,e as y}from"./chunk-DZI5S33S.js";import{a as t}from"./chunk-D7WMKMTL.js";function q({name:o,label:k,required:C,value:c}){let[b,v]=n(!1),[r,l]=n(c||null),[d,p]=n([]),[a,u]=n(c?.primary_name??""),[R]=n({delay:S(u,220)}),s=y(()=>{v(document.activeElement===document.querySelector(`input[name="${o}.primary_name"]`))},[]);m(()=>(s(),self.addEventListener("click",s),()=>self.removeEventListener("click",s)));let w=async()=>{if(!a){p([]);return}let $=await(await fetch(`https://clinicaltables.nlm.nih.gov/api/conditions/v3/search?terms=${encodeURIComponent(a)}&df=key_id,primary_name`)).json();p($[3].map(([E,F])=>({key_id:`c_${E}`,primary_name:F})))};m(()=>{w()},[a]);let I=b&&r?.primary_name!==a&&(d.length>0||a);return t(g,{className:"w-full",children:[t(h,{name:`${o}.primary_name`,label:k,value:r?.primary_name,placeholder:"Search for conditions",required:C,onInput:e=>{i(e.target),i("value"in e.target),i(typeof e.target.value=="string"),l(null),R.delay(e.target.value)},children:I&&t(_,{children:d.map(e=>t(f,{condition:e.primary_name,isSelected:r?.key_id===e?.key_id,onSelect:()=>{l({key_id:e.key_id,primary_name:e.primary_name}),u(e.primary_name)}}))})}),r&&t("input",{type:"hidden",name:`${o}.key_id`,value:r.key_id})]})}export{q as a};
