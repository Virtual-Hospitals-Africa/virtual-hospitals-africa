import{a as h,d as S,h as f}from"./chunk-6NEEI67K.js";import{a as n}from"./chunk-QPM7RCMO.js";import{g as p}from"./chunk-S3N45IXZ.js";import{a as c,b as o,e as m}from"./chunk-DZI5S33S.js";import{a as t}from"./chunk-D7WMKMTL.js";function E({name:s,selectedDrug:r,clearSelected:_,setSelectedDrug:R}){let[D,y]=c(!1),[i,l]=c([]),[a,d]=c(r?.drug_generic_name??""),[v]=c({delay:f(d,220)}),u=m(()=>{y(document.activeElement===document.querySelector(`input[name="${s}.generic_name"]`))},[]);o(()=>(u(),self.addEventListener("click",u),()=>self.removeEventListener("click",u)));let w=async()=>{if(!a)return l([]);let e=new URL(`${window.location.origin}/app/drugs`);e.searchParams.set("search",a),await fetch(e,{headers:{accept:"application/json"}}).then(async k=>{let g=await k.json();n(Array.isArray(g)),l(g)}).catch(console.error)};o(()=>{w()},[a]);let I=D&&r?.drug_generic_name!==a&&(i.length>0||a);return t(p,{name:`${s}.generic_name`,label:"Drug",value:r?.drug_generic_name,required:!0,onInput:e=>{n(e.target),n("value"in e.target),n(typeof e.target.value=="string"),_(),v.delay(e.target.value)},children:[I&&t(S,{children:i.map(e=>t(h,{drug:e,isSelected:r?.drug_id===e.drug_id,onSelect:()=>{R(e),d(e.drug_generic_name)}}))}),r&&t("input",{type:"hidden",name:`${s}.drug_id`,value:r.drug_id})]})}export{E as a};
