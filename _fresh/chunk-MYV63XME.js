import{d as h,e as d,h as f}from"./chunk-6NEEI67K.js";import{a}from"./chunk-QPM7RCMO.js";import{g as y}from"./chunk-S3N45IXZ.js";import{a as t,b as c,e as g}from"./chunk-DZI5S33S.js";import{a as s}from"./chunk-D7WMKMTL.js";function R({without_ids:n,addAllergy:p}){let[r,o]=t(""),[i,u]=t([]),[S]=t({delay:f(o,220)}),[A,v]=t(!1),w=async()=>{if(!r)return u([]);let e=new URL(`${window.location.origin}/app/allergies`);e.searchParams.set("search",r),n?.length&&e.searchParams.set("without_ids",n.join(",")),await fetch(e,{headers:{accept:"application/json"}}).then(async E=>{let m=await E.json();a(Array.isArray(m)),u(m)}).catch(console.error)};c(()=>{w()},[r]);let l=g(()=>{v(document.activeElement===document.querySelector('input[name="allergy_search"]'))},[]);return c(()=>(l(),self.addEventListener("click",l),()=>self.removeEventListener("click",l))),s(y,{name:"allergy_search",label:"Allergies",value:r,onInput:e=>{a(e.target),a("value"in e.target),a(typeof e.target.value=="string"),S.delay(e.target.value)},children:A&&r&&i.length>0&&s(h,{children:i.map(e=>s(d,{allergy:e.name,onSelect:()=>{p({allergy_id:e.id,name:e.name}),o("")}}))})})}export{R as a};
