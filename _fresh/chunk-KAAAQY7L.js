import{b as g,d as b,g as y,h as I}from"./chunk-6NEEI67K.js";import{a as r}from"./chunk-QPM7RCMO.js";import{g as v}from"./chunk-S3N45IXZ.js";import{a as s,b as h,e as S}from"./chunk-DZI5S33S.js";import{a as t}from"./chunk-D7WMKMTL.js";import{d as m}from"./chunk-AKT74HKI.js";function L({href:N,name:l,required:w,label:R,value:p,addable:$}){let[k,E]=s(!1),[n,i]=s(p||null),[f,P]=s([]),[a,u]=s(p?.name??""),[q]=s({delay:I(u,220)}),d=S(()=>{E(document.activeElement===document.querySelector(`input[name="${l}_name"]`))},[]);h(()=>(d(),self.addEventListener("click",d),()=>self.removeEventListener("click",d))),h(()=>{let e=new URL(`${window.location.origin}${N}`);e.searchParams.set("search",a),fetch(e,{headers:{accept:"application/json"}}).then(async H=>{let c=await H.json();r(Array.isArray(c)),r(c.every(o=>o&&typeof o=="object")),r(c.every(o=>o.id&&typeof o.id=="number")),P(c)}).catch(console.error)},[a]);let A=k&&n?.name!==a&&(f.length>0||a&&$);return t("div",{className:"w-full",children:[t(v,{name:`${l}_name`,label:R,value:n?.name,required:w,onInput:e=>{r(e.target),r("value"in e.target),r(typeof e.target.value=="string"),i(null),q.delay(e.target.value)},children:A&&t(b,{children:[t(m,{children:f.map(e=>t(g,{person:e,isSelected:n?.id===e.id,onSelect:()=>{i(e),u(e.name)}}))}),t(m,{children:t(y,{searchedValue:a,isSelected:n?.id==Number.NaN,onSelect:()=>{i({name:a,id:Number.NaN}),u(a)}})})]})}),n&&t("input",{type:"hidden",name:`${l}_id`,value:n.id})]})}export{L as a};
